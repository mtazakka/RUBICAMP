<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="	https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css">
    <title>Document</title>
</head>

<body>
    <div class="container mt-5 mb-5"></div>
    <table class="table table-dark table-striped" id:'listingTable'>
        <thead>
            <tr>
                <th scope="col">BTC price</th>
                <th scope="col">Rank</th>
                <th scope="col">Tier</th>
                <th scope="col">Name</th>
                <th scope="col">Price</th>
                <th scope="col">Symbol</th>
            </tr>
        </thead>
        <tbody id="data">

        </tbody>
    </table>
    <nav>
        <ul class="pagination">
            <li class="page-item">
                <button class="page-link mx-2" id='prevButton'>Previous</button>
            </li>
            <li class="page-item">
                <button class="page-link mx-2" id='nextButton'>Next</button>
            </li>
        </ul>
    </nav>
    <!-- <script src="app.js"></script> -->
    <script>
        var baseUrl = "https://api.coinranking.com/v2/coins"
        var proxyURL = "https://cors-anywhere.herokuapp.com/"
        var apiURL = `${proxyURL}${baseUrl}`
        var coinsData = []

        let pageSize = 10
        let currentPage = 1
        async function renderTable() {
            await getData()

            var cryptoCoin = ''
            console.log(coinsData)
            coinsData.filter((row, index) => {
                let start = (currentPage - 1) * pageSize
                let end = currentPage * pageSize

                if (index >= start && index < end) return true;
            }).forEach(coin => {
                cryptoCoin += "<tr>"
                cryptoCoin += `<td>${parseFloat(coin.btcPrice).toFixed(6)}</td>`
                cryptoCoin += `<td>${coin.rank}</td>`
                cryptoCoin += `<td>${coin.tier}</td>`
                cryptoCoin += `<td>${coin.name}</td>`
                cryptoCoin += `<td>${Math.round(coin.price)} Billion</td>`
                cryptoCoin += `<td>${coin.symbol}</td>`
                "<tr>"
            })
            document.getElementById("data").innerHTML = cryptoCoin
        }
        renderTable()

        function previousPage() {
            if (currentPage > 1)
                currentPage--;
            renderTable()
        }
        function nextPage() {
            if ((currentPage * pageSize) < coinsData.length)
                currentPage++;
            renderTable()
        }

        document.querySelector('#prevButton').addEventListener('click', previousPage, false)
        document.querySelector('#nextButton').addEventListener('click', nextPage, false)

        //FETCH DATA
        async function getData() {
            const response = await fetch(apiURL);
            const coins = await response.json()
            coinsData = coins.data.coins

        }
        getData()
    </script>
</body>

</html>